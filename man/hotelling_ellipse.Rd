% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats.R
\name{hotelling_ellipse}
\alias{hotelling_ellipse}
\title{Calculate Hotelling or data ellipse around some points}
\usage{
hotelling_ellipse(
  x,
  level = 0.95,
  npoints = 100,
  type = c("t2data", "t2mean", "c2data"),
  robust = FALSE
)
}
\arguments{
\item{x}{A two-column matrix or data frame like object}

\item{level}{Either coverage probability (for type = "t2data" or "c2data") or
confidence level (for type = "t2mean").}

\item{npoints}{Number of points to estimate}

\item{type}{t2data - Hotelling T2 data ellipse; t2mean - Hotelling
confidence interval for the mean; c2data - normal
data elllipse (using chi squared distribution).}

\item{robust}{If TRUE, then robust estimates of mean and covariance are
used}
}
\value{
A two-column matrix or data frame with npoints rows
}
\description{
Calculate Hotelling or data ellipse around some points
}
\details{
Calculate the T2 Hotelling ellipse or a data ellipse for
the given coverage probability. There are three types of ellipses which
can be plotted:
\itemize{
\item T2 Hotelling data ellipses, showing data coverage (like the
\code{type="t"} version of \code{stat_ellipse})
\item normal multivariate distribution ellipses (like the \code{type="norm"}
version of the \code{stat_ellipse}) which use Mahalonibis distance and
chi-squared statistic
\item T2 Hotelling confidence ellipses of the group means.
}

The latter (for group means) correspond to the confidence interval for
the mean in the univariate world, so the ellipses are very small
(depending on the number of points).

The function can also use a robust estimator of location and scatter
using the \code{\link[robustbase]{covMcd}} function, which uses the
Maximum Covariance Determinant (MCD) estimator. Note that while this
results in ellipses which are more resistent to outliers, the
interpretation slightly changes, as the T2 statistic used is only an
approximation in this case. In other words, use it for visualisation and
QC, but not for statistical testing.
}
\examples{
df <- iris[ iris$Species == "setosa", 1:2 ]
eli <- hotelling_ellipse(df)
plot(df[,1], df[,2])
lines(eli)
}
\seealso{
\code{\link[=outliers]{outliers()}} for calculating per-point based T2 and
Mahalonibis values and \code{\link[=geom_hotelling]{geom_hotelling()}} for plotting of the ellipse with
ggplot
}
