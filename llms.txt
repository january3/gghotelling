# Hotelling’s T² Ellipses and Outlier Detection for ggplot2

Here are a few examples of plots you can create with `gghotelling`:

![](reference/figures/README-example-nocode-1.png)

# Features:

- Classical Hotelling and data ellipses with
  [`geom_hotelling()`](https://january3.github.io/gghotelling/reference/geom_hotelling.md)
- Robust Hotelling ellipses using MCD estimator with `robust=TRUE`
- Hotelling confidence ellipses for group means with `type="t2mean"`
- Kernel density coverage contours with
  [`geom_kde()`](https://january3.github.io/gghotelling/reference/geom_kde.md)
- Outlier detection with
  [`outliers()`](https://january3.github.io/gghotelling/reference/outliers.md)
- Outlier visualization with
  [`stat_outliers()`](https://january3.github.io/gghotelling/reference/stat_outliers.md)
  and
  [`plot_outliers()`](https://january3.github.io/gghotelling/reference/outliers.md)
- Convex hulls with
  [`geom_hull()`](https://january3.github.io/gghotelling/reference/geom_hull.md)
- Bagplots with
  [`geom_bag()`](https://january3.github.io/gghotelling/reference/geom_bag.md)
- Autoplot and autolayer methods for `prcomp` objects

See [the
vignette](https://january3.github.io/gghotelling/articles/gghotelling.html)
for more details.

## Installation

You can install the development version of gghotelling from
[GitHub](https://github.com/january3/gghotelling/) with:

``` r
# install.packages("pak")
pak::pak("january3/gghotelling")
```

## Minimal Example

The package defines a new geom,
[`geom_hotelling()`](https://january3.github.io/gghotelling/reference/geom_hotelling.md),
which can be used to add Hotelling ellipses to ggplot2 scatter plots.
Here are two examples of usage:

``` r
library(ggplot2)
library(gghotelling)

pca <- prcomp(iris[, 1:4], scale.=TRUE)
df <- cbind(iris, pca$x)

# minimum example
p1 <- ggplot(df, aes(PC1, PC2, color=Species)) +
  geom_hotelling() +
  geom_point()

# set custom CI/coverage level
p2 <- ggplot(df, aes(PC1, PC2, color=Species)) +
  geom_hotelling(alpha=0.1, aes(fill = Species), level=.99) +
  geom_point()

plot_grid(p1, p2, ncol=2)
```

![](reference/figures/README-example-1.png)

# Package index

## All functions

- [`autoplot(`*`<prcomp>`*`)`](https://january3.github.io/gghotelling/reference/autoplot.prcomp.md)
  [`autolayer(`*`<prcomp>`*`)`](https://january3.github.io/gghotelling/reference/autoplot.prcomp.md)
  : Automatic plotting of PCA objects
- [`geom_bag()`](https://january3.github.io/gghotelling/reference/geom_bag.md)
  : Bag plots
- [`geom_hotelling()`](https://january3.github.io/gghotelling/reference/geom_hotelling.md)
  : Hotelling ellipses for ggplot2
- [`geom_hull()`](https://january3.github.io/gghotelling/reference/geom_hull.md)
  : Draw a convex hull around a group of points
- [`geom_kde()`](https://january3.github.io/gghotelling/reference/geom_kde.md)
  : KDE contours for ggplot2
- [`hotelling_ellipse()`](https://january3.github.io/gghotelling/reference/hotelling_ellipse.md)
  : Calculate Hotelling or data ellipse around some points
- [`outliers()`](https://january3.github.io/gghotelling/reference/outliers.md)
  [`plot_outliers()`](https://january3.github.io/gghotelling/reference/outliers.md)
  : Calculate the T2 statistic for individual points
- [`stat_outliers()`](https://january3.github.io/gghotelling/reference/stat_outliers.md)
  : Calculate per-point T² Hotelling statistic

# Articles

### All vignettes

- [Hotelling ellipses, contours and
  outliers](https://january3.github.io/gghotelling/articles/gghotelling.md):
