[{"path":"https://january3.github.io/gghotelling/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 gghotelling authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"hotellings-t²-ellipses-and-outlier-detection-for-ggplot2","dir":"Articles","previous_headings":"","what":"Hotelling’s T² Ellipses and Outlier Detection for ggplot2","title":"Hotelling ellipses, contours and outliers","text":"Hotelling data ellipses use Hotelling T² distribution create coverage regions distribution data, often used outlier detection multivariate data. Features: Classical Hotelling data ellipses Robust Hotelling ellipses using MCD estimator Hotelling confidence ellipses group means Kernel density coverage contours geom_kde() Outlier detection visualization stat_outliers() Convex hulls geom_hull() Autoplot method prcomp objects","code":""},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"installation","dir":"Articles","previous_headings":"Hotelling’s T² Ellipses and Outlier Detection for ggplot2","what":"Installation","title":"Hotelling ellipses, contours and outliers","text":"can install development version gghotelling GitHub :","code":"# install.packages(\"pak\") pak::pak(\"january3/gghotelling\")"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"hotelling-ellipses","dir":"Articles","previous_headings":"","what":"Hotelling Ellipses","title":"Hotelling ellipses, contours and outliers","text":"package defines new geom, geom_hotelling(), can used add Hotelling ellipses ggplot2 scatter plots.","code":"library(ggplot2) library(gghotelling)  pca <- prcomp(iris[, 1:4], scale.=TRUE) pca_df <- cbind(iris, pca$x)  ggplot(pca_df, aes(PC1, PC2)) +   geom_hotelling(level=.99) +   geom_point() ggplot(pca_df, aes(PC1, PC2, color=Species)) +   geom_hotelling() +   geom_point() ggplot(pca_df, aes(PC1, PC2, color=Species)) +   geom_hotelling(alpha=0.1, aes(fill = Species)) +   geom_point() # set custom CI/coverage level ggplot(pca_df, aes(PC1, PC2, color=Species)) +   geom_hotelling(alpha=0.1, aes(fill = Species), level=.99) +   geom_point()"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"outlier-detection","dir":"Articles","previous_headings":"","what":"Outlier Detection","title":"Hotelling ellipses, contours and outliers","text":"package also provides per-point, group-wise T² statistics can used identify multivariate outliers.  stat_outliers() function computes Hotelling T² statistic point compares critical value Hotelling T² distribution specified confidence level (default 0.95). new data available aesthetics via after_stat(), including: t2: Hotelling T² statistic point c2: χ² statistic point is_outlier: logical indicating whether point outlier variables can used, stat_outliers(), map aesthetics color, shape, size highlight outliers. example:  can useful identifying potential outliers multivariate data. outliers can directly labeled follows:  even better, using ggrepel avoid overlapping labels:  actual calculation Hotelling T² statistics critical values done function outliers(), can also used directly data frames compute statistics without plotting:","code":"ggplot(pca_df, aes(PC1, PC2, group=Species)) +   geom_hotelling(level = 0.75, alpha=0.1, aes(fill = Species)) +   scale_color_manual(values=c(\"TRUE\"=\"red\", \"FALSE\"=\"grey\")) +   stat_outliers(level = .75, aes(shape = Species, color = after_stat(is_outlier))) ggplot(pca_df, aes(PC1, PC2, group=Species)) +   geom_hotelling(alpha=0.1, aes(fill = Species)) +   stat_outliers(size=2, aes(shape = Species, color = after_stat(t2))) ggplot(pca_df, aes(PC1, PC2, group=Species, label=rownames(pca_df))) +   geom_hotelling(alpha=0.1, aes(fill = Species)) +   geom_point(aes(color = Species)) +   stat_outliers(geom=\"label\",                          outlier_only = TRUE) library(ggrepel) ggplot(pca_df, aes(PC1, PC2, group=Species, label=rownames(pca_df))) +   geom_hotelling(alpha=0.1, aes(fill = Species)) +   geom_point(aes(color = Species)) +   stat_outliers(geom=\"label_repel\",                         outlier_only = TRUE) outlier_stats <- outliers(pca_df[, c(\"PC1\", \"PC2\")], level = 0.95)  head(outlier_stats) #>         t2   t2crit       c2   c2crit is_outlier #> 1 1.996071 6.155707 1.996071 5.991465      FALSE #> 2 1.967770 6.155707 1.967770 5.991465      FALSE #> 3 2.029500 6.155707 2.029500 5.991465      FALSE #> 4 2.187372 6.155707 2.187372 5.991465      FALSE #> 5 2.398597 6.155707 2.398597 5.991465      FALSE #> 6 3.876401 6.155707 3.876401 5.991465      FALSE"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"robust-hotelling-ellipses","dir":"Articles","previous_headings":"","what":"Robust Hotelling Ellipses","title":"Hotelling ellipses, contours and outliers","text":"Robust Hotelling ellipses can created setting robust=TRUE argument geom_hotelling() stat_outliers(). uses Minimum Covariance Determinant (MCD) estimator robustbase package compute robust estimates mean covariance matrix, used compute Hotelling chi-squared data ellipses. Robust ellipses less sensitive outliers can provide accurate representation data distribution outliers present. showing comparison classical robust Hotelling ellipses presence outliers. data set used, wine, contains chemical analysis various wines, several obvious outliers, figure recapitulates figure 1 paper Hubert et al. (Hubert, Debruyne, Rousseeuw 2018).  one can see, MDCD based robust Hotelling ellipse (blue) provides much tighter fit main data cluster, classical Hotelling ellipse (red) heavily influenced outliers, resulting much larger skewed ellipse.","code":"library(HDclassif) #> Loading required package: MASS data(wine) wine <- wine[ wine$class == 1, ] wine <- data.frame(\"malic_acid\"=wine$V2, \"proline\"=wine$V13)  ggplot(wine, aes(malic_acid, proline)) +   geom_hotelling(type=\"data\", level = .975, color = \"red\") +   geom_hotelling(type=\"data\", level = .975, robust = TRUE, color = \"blue\") +   geom_point() +   annotate(\"text\", x=2.5, y = 1675, label = \"MCD\", color = \"blue\") +   annotate(\"text\", x=3.5, y = 1400, label = \"Classical\", color = \"red\")"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"convex-hulls-and-contours","dir":"Articles","previous_headings":"","what":"Convex Hulls and contours","title":"Hotelling ellipses, contours and outliers","text":"package provides basic convex hull:  Furthermore, also geom_kde() draw 2D kernel density estimate. Unlike geom_density_2d(), function actually creates single contour specified coverage; example, coverage=0.95, contour encloses roughly 95% data points. useful visualizing density distribution non-elliptical data:  can see, geom_kde() contour nicely captures non-elliptical distribution data, convex hull includes large empty area. course, can also use aesthetics like fill geom_kde() overlay several contours:","code":"ggplot(iris, aes(Sepal.Length, Sepal.Width, color=Species)) +   geom_hull(mapping = aes(fill = Species), alpha=.1) +   geom_point() df <- data.frame(x=rnorm(500) + 5) df$y <- df$x^5 + rnorm(500)*500 ggplot(df, aes(x=x, y=y)) +   geom_point()+   geom_hull(color = \"grey\") +   geom_kde(color=\"red\", linewidth=1) # interesting little fact: ggplot2 happily accepts lists of geoms/layers # and adds them one by one to the plot  rings <- lapply(seq(.05, .95, length.out = 10), \\(i) {   geom_kde(aes(fill = Species), alpha =.05, coverage = i) })  ggplot(pca_df, aes(x = PC1, y = PC2, color=Species)) +   rings +   geom_point()"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"autoplot","dir":"Articles","previous_headings":"","what":"Autoplot","title":"Hotelling ellipses, contours and outliers","text":"package also defines autoplot.prcomp autolayer.prcomp convenient plotting PCA plots. Note autoplot.prcomp also implemented sophisticated way ggfortify package.","code":"autoplot(pca, group = iris$Species) +    autolayer(pca, group = iris$Species)"},{"path":"https://january3.github.io/gghotelling/articles/gghotelling.html","id":"other-packages-of-interest","dir":"Articles","previous_headings":"","what":"Other packages of interest","title":"Hotelling ellipses, contours and outliers","text":"Many packages provide functionality creating data ellipses outlier detection multivariate data, including ellipse, car, ggfortify, ggplot2 . , , create yet another package? Hotelling ellipses returned geom_hotelling() different ellipses returned ellipse::ellipse() car::dataEllipse() functions, produce data ellipses based Mahalanobis distance contour χ² distribution quantiles (actually, without getting details, dataEllipse() sophisticated, far understand produce Hotelling ellipses). Mahalanobis distance ellipses Hotelling T² ellipses represent shape spread data distribution, actually based covariance matrix mean vector data, however use different statistical distributions define contour levels (Hotelling T² χ², respectively), leading different scaling ellipses. geom_hotelling() also different stat_ellipse() can also used create data ellipses ggplot2; similarly ellipse::ellipse() car::dataEllipse(), stat_ellipse() uses Mahalanobis distance contours based χ² distribution quantiles. contrast, gghotelling provides explicit Hotelling T² data ellipses Hotelling T² confidence ellipses, clear distinction two, well data ellipses based χ² distribution. Unlike stat_ellipse(), can also take fill aesthetic visually pleasing representation ellipses. addition gghotelling provides robust versions ellipses using MCD estimator, available packages. lot functionality overlaps ggfortify::ggbiplot() (extension autoplot.pca_class), function less flexible separate geom can add figure. main motivation creating package sorting different ellipse types allowing use fill aesthetics Hotelling ellipses. tried make usage convenient, simple intuitive.","code":""},{"path":[]},{"path":"https://january3.github.io/gghotelling/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"January Weiner. Author, maintainer.","code":""},{"path":"https://january3.github.io/gghotelling/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Weiner J (2025). gghotelling: Hotelling's T² Ellipses Outlier Detection ggplot2. R package version 0.0.0.9015, https://january3.github.io/gghotelling/.","code":"@Manual{,   title = {gghotelling: Hotelling's T² Ellipses and Outlier Detection for ggplot2},   author = {January Weiner},   year = {2025},   note = {R package version 0.0.0.9015},   url = {https://january3.github.io/gghotelling/}, }"},{"path":"https://january3.github.io/gghotelling/index.html","id":"hotellings-t²-ellipses-and-outlier-detection-for-ggplot2-","dir":"","previous_headings":"","what":"Hotelling's T² Ellipses and Outlier Detection for ggplot2","title":"Hotelling's T² Ellipses and Outlier Detection for ggplot2","text":"examples plots can create gghotelling:","code":"#> Loading required package: MASS"},{"path":"https://january3.github.io/gghotelling/index.html","id":"features","dir":"","previous_headings":"","what":"Features:","title":"Hotelling's T² Ellipses and Outlier Detection for ggplot2","text":"Classical Hotelling data ellipses Robust Hotelling ellipses using MCD estimator Hotelling confidence ellipses group means Kernel density coverage contours geom_kde() Outlier detection visualization stat_outliers() Convex hulls geom_hull() Autoplot method prcomp objects See vignette details.","code":""},{"path":"https://january3.github.io/gghotelling/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hotelling's T² Ellipses and Outlier Detection for ggplot2","text":"can install development version gghotelling GitHub :","code":"# install.packages(\"pak\") pak::pak(\"january3/gghotelling\")"},{"path":"https://january3.github.io/gghotelling/index.html","id":"minimal-example","dir":"","previous_headings":"","what":"Minimal Example","title":"Hotelling's T² Ellipses and Outlier Detection for ggplot2","text":"package defines new geom, geom_hotelling(), can used add Hotelling ellipses ggplot2 scatter plots.","code":"library(ggplot2) library(gghotelling)  pca <- prcomp(iris[, 1:4], scale.=TRUE) df <- cbind(iris, pca$x)  # minimum example p1 <- ggplot(df, aes(PC1, PC2, color=Species)) +   geom_hotelling() +   geom_point()  # set custom CI/coverage level p2 <- ggplot(df, aes(PC1, PC2, color=Species)) +   geom_hotelling(alpha=0.1, aes(fill = Species), level=.99) +   geom_point()  plot_grid(p1, p2, ncol=2)"},{"path":"https://january3.github.io/gghotelling/reference/autoplot.prcomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatic plotting of PCA objects — autoplot.prcomp","title":"Automatic plotting of PCA objects — autoplot.prcomp","text":"Automatic plotting PCA objects","code":""},{"path":"https://january3.github.io/gghotelling/reference/autoplot.prcomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatic plotting of PCA objects — autoplot.prcomp","text":"","code":"# S3 method for class 'prcomp' autoplot(object, dims = c(1, 2), biplot = FALSE, group = NULL, ...)  # S3 method for class 'prcomp' autolayer(   object,   dims = c(1, 2),   group = NULL,   labels = NULL,   type = c(\"t2data\", \"t2mean\", \"data\"),   level = 0.95,   ... )"},{"path":"https://january3.github.io/gghotelling/reference/autoplot.prcomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatic plotting of PCA objects — autoplot.prcomp","text":"object object prcomp class dims Dimensions plot biplot whether show loadings well scores group Groups data shown plot ... ignored labels optionally, vector labels showing outliers. NULL, outliers identified row number. type type coverage / confidence area shown autolayer.prcomp, can one t2data (T² Hotelling coverage), data (Mahalanobis coverage) t2mean (confidence area group mean). level Either coverage probability (type = \"t2data\" \"data\") confidence level (type = \"t2mean\").","code":""},{"path":"https://january3.github.io/gghotelling/reference/autoplot.prcomp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Automatic plotting of PCA objects — autoplot.prcomp","text":"functions autoplot.prcomp autolayer.prcomp automatic plotting prcomp objects, similar ggfortify::autoplot.prcomp.","code":""},{"path":"https://january3.github.io/gghotelling/reference/autoplot.prcomp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Automatic plotting of PCA objects — autoplot.prcomp","text":"","code":"pca <- prcomp(iris[,1:4], scale.=TRUE)  library(ggplot2) autoplot(pca, group = iris$Species) +    autolayer(pca, group = iris$Species)"},{"path":"https://january3.github.io/gghotelling/reference/geom_hotelling.html","id":null,"dir":"Reference","previous_headings":"","what":"Hotelling ellipses for ggplot2 — GeomKDE","title":"Hotelling ellipses for ggplot2 — GeomKDE","text":"Hotelling ellipses ggplot2","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_hotelling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hotelling ellipses for ggplot2 — GeomKDE","text":"","code":"geom_hotelling(   mapping = NULL,   data = NULL,   position = \"identity\",   ...,   level = 0.95,   type = \"t2data\",   robust = FALSE,   npoints = 100,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://january3.github.io/gghotelling/reference/geom_hotelling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hotelling ellipses for ggplot2 — GeomKDE","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... Additional parameters passed underlying ggplot2::geom_polygon() ggplot2::layer(). level Either coverage probability (type = \"t2data\" \"data\") confidence level (type = \"t2mean\"). type t2data - Hotelling T² data ellipse; t2mean - Hotelling confidence interval mean; data - normal data elllipse (using χ² distribution). robust TRUE, robust estimates mean covariance used npoints Number points estimate na.rm Logical. missing values removed? Default FALSE. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders().","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_hotelling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hotelling ellipses for ggplot2 — GeomKDE","text":"geom adds data confidence ellipses plot. See hotelling_ellipse() documentation information.","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_hotelling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hotelling ellipses for ggplot2 — GeomKDE","text":"","code":"pca <- prcomp(iris[, 1:4], scale.=TRUE) df <- cbind(iris, pca$x) library(ggplot2)      ggplot(df, aes(PC1, PC2)) +     geom_hotelling(level=.99) +     geom_point()       ggplot(df, aes(PC1, PC2, color=Species)) +     geom_hotelling() +     geom_point()       ggplot(df, aes(PC1, PC2, color=Species)) +     geom_hotelling(alpha=0.1, aes(fill = Species)) +     geom_point()     # compare the robust and regular approaches:   ggplot(df, aes(PC1, PC2, color=Species)) +     geom_hotelling() +     geom_hotelling(robust = TRUE, linetype = \"dashed\") +     geom_point()"},{"path":"https://january3.github.io/gghotelling/reference/geom_hull.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw a convex hull around a group of points — GeomHull","title":"Draw a convex hull around a group of points — GeomHull","text":"Draw convex hull around group points","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_hull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw a convex hull around a group of points — GeomHull","text":"","code":"geom_hull(   mapping = NULL,   data = NULL,   position = \"identity\",   ...,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://january3.github.io/gghotelling/reference/geom_hull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw a convex hull around a group of points — GeomHull","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... Additional parameters passed underlying ggplot2::geom_polygon() ggplot2::layer(). na.rm Logical. missing values removed? Default FALSE. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders().","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_hull.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw a convex hull around a group of points — GeomHull","text":"","code":"# nothing library(ggplot2) ggplot(iris, aes(Sepal.Length, Sepal.Width, color=Species)) +   geom_hull(mapping = aes(fill = Species), alpha=.1) +   geom_point()"},{"path":"https://january3.github.io/gghotelling/reference/geom_kde.html","id":null,"dir":"Reference","previous_headings":"","what":"KDE contours for ggplot2 — StatKDE","title":"KDE contours for ggplot2 — StatKDE","text":"Kernel density estimate contours ggplot2","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_kde.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"KDE contours for ggplot2 — StatKDE","text":"","code":"geom_kde(   mapping = NULL,   data = NULL,   position = \"identity\",   ...,   coverage = 0.95,   n = 100,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://january3.github.io/gghotelling/reference/geom_kde.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"KDE contours for ggplot2 — StatKDE","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... Additional parameters passed underlying ggplot2::geom_polygon() ggplot2::layer(). coverage fraction points enclosed contour n Number grid points direction (passed kde2d) show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders().","code":""},{"path":"https://january3.github.io/gghotelling/reference/geom_kde.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"KDE contours for ggplot2 — StatKDE","text":"function uses kde2d function estimate density along grid, plots contour selected coverage.","code":""},{"path":[]},{"path":"https://january3.github.io/gghotelling/reference/geom_kde.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"KDE contours for ggplot2 — StatKDE","text":"","code":"library(ggplot2)    pca <- prcomp(iris[, 1:4], scale.=TRUE) df <- cbind(iris, pca$x)    # following is similar to geom_contour pca <- prcomp(iris[, 1:4], scale.=TRUE) df <- cbind(iris, pca$x) p <- ggplot(df, aes(x = PC1, y = PC2, color=Species)) for(i in seq(.05, .95, length.out = 10)) {   p <- p + geom_kde(aes(fill = Species), alpha =.05, coverage = i, n = 100) } p + geom_point()"},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"Calculate Hotelling data ellipse around points","code":""},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"","code":"hotelling_ellipse(   x,   level = 0.95,   npoints = 100,   type = c(\"t2data\", \"t2mean\", \"data\"),   robust = FALSE )"},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"x two-column matrix data frame like object level Either coverage probability (type = \"t2data\" \"data\") confidence level (type = \"t2mean\"). npoints Number points estimate type t2data - Hotelling T² data ellipse; t2mean - Hotelling confidence interval mean; data - normal data elllipse (using χ² distribution). robust TRUE, robust estimates mean covariance used","code":""},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"two-column matrix data frame npoints rows","code":""},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"Calculate T² Hotelling ellipse data ellipse given coverage probability. three types ellipses can plotted: T² Hotelling data ellipses, showing data coverage (like type=\"t\" version stat_ellipse) normal multivariate distribution ellipses (like type=\"norm\" version stat_ellipse) use Mahalonibis distance chi-squared statistic T² Hotelling confidence ellipses group means. latter (group means) correspond confidence interval mean univariate world, ellipses small (depending number points). function can also use robust estimator location scatter using covMcd function, uses Maximum Covariance Determinant (MCD) estimator. Note results ellipses resistent outliers, interpretation slightly changes, T² statistic used approximation case. words, use visualisation QC, statistical testing.","code":""},{"path":[]},{"path":"https://january3.github.io/gghotelling/reference/hotelling_ellipse.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Hotelling or data ellipse around some points — hotelling_ellipse","text":"","code":"df <- iris[ iris$Species == \"setosa\", 1:2 ] eli <- hotelling_ellipse(df) plot(df[,1], df[,2]) lines(eli)"},{"path":"https://january3.github.io/gghotelling/reference/outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the T2 statistic for individual points — outliers","title":"Calculate the T2 statistic for individual points — outliers","text":"Calculate T2 statistic Mahalanobis distance individual points","code":""},{"path":"https://january3.github.io/gghotelling/reference/outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the T2 statistic for individual points — outliers","text":"","code":"outliers(x, level = 0.95, robust = FALSE, type = c(\"t2data\", \"t2mean\", \"data\"))"},{"path":"https://january3.github.io/gghotelling/reference/outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the T2 statistic for individual points — outliers","text":"x matrix data frame two columns level Either coverage probability (type = \"t2data\" \"data\") confidence level (type = \"t2mean\"). robust TRUE, robust estimates mean covariance used type type statistic calculated; can t2data (data coverage), t2mean (difference mean) \"data\" (Mahalanobis distance)","code":""},{"path":"https://january3.github.io/gghotelling/reference/outliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the T2 statistic for individual points — outliers","text":"data frame one row per point including columns t2 (t2 statistic), t2crit (critical t2 value given level) is_outlier (logical, whether t2 > t2crit).","code":""},{"path":"https://january3.github.io/gghotelling/reference/outliers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the T2 statistic for individual points — outliers","text":"function can use robust estimator location scatter using covMcd function, uses Maximum Covariance Determinant (MCD) estimator. Note results ellipses resistent outliers, interpretation slightly changes, T² statistic used approximation case. words, use visualisation QC, statistical testing.","code":""},{"path":[]},{"path":"https://january3.github.io/gghotelling/reference/stat_outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate per-point T² Hotelling statistic — StatOutliers","title":"Calculate per-point T² Hotelling statistic — StatOutliers","text":"Calculate per-point T² Hotelling statistic use ggplot","code":""},{"path":"https://january3.github.io/gghotelling/reference/stat_outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate per-point T² Hotelling statistic — StatOutliers","text":"","code":"stat_outliers(   mapping = NULL,   data = NULL,   geom = \"point\",   position = \"identity\",   ...,   type = c(\"t2data\", \"data\", \"t2mean\"),   level = 0.95,   outlier_only = FALSE,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://january3.github.io/gghotelling/reference/stat_outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate per-point T² Hotelling statistic — StatOutliers","text":"mapping Set aesthetic mappings created aes(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify() variables created. function called single argument, plot data. return value must data.frame, used layer data. function can created formula (e.g. ~ head(.x, 10)). geom geometric object use display data layer. using stat_*() function construct layer, geom argument can used override default coupling stats geoms. geom argument accepts following: Geom ggproto subclass, example GeomPoint. string naming geom. give geom string, strip function name geom_ prefix. example, use geom_point(), give geom \"point\". information ways specify geom, see layer geom documentation. position position adjustment use data layer. can used various ways, including prevent overplotting improving display. position argument accepts following: result calling position function, position_jitter(). method allows passing extra arguments position. string naming position adjustment. give position string, strip function name position_ prefix. example, use position_jitter(), give position \"jitter\". information ways specify position, see layer position documentation. ... Additional parameters passed underlying ggplot2::geom_polygon() ggplot2::layer(). type t2data - Hotelling T² data ellipse; t2mean - Hotelling confidence interval mean; data - normal data elllipse (using χ² distribution). level Either coverage probability (type = \"t2data\" \"data\") confidence level (type = \"t2mean\"). outlier_only return statistic outliers na.rm Logical. missing values removed? Default FALSE. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. include legend keys levels, even data exists, use TRUE.  NA, levels shown legend, unobserved levels omitted. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. annotation_borders().","code":""},{"path":"https://january3.github.io/gghotelling/reference/stat_outliers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate per-point T² Hotelling statistic — StatOutliers","text":"calculates T² Hotelling statistic point plot, group-wise. allows use statistics is_outlier t2 used graphical parameters, e.g. coloring points (see Examples ) using ggplot2::after_stat() function.","code":""},{"path":"https://january3.github.io/gghotelling/reference/stat_outliers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate per-point T² Hotelling statistic — StatOutliers","text":"","code":"pca <- prcomp(iris[, 1:4], scale.=TRUE) df <- cbind(iris, pca$x)  library(ggplot2) ggplot(df, aes(PC1, PC2, group=Species)) +   geom_hotelling(alpha=0.1, aes(fill = Species)) +   scale_color_manual(values=c(\"TRUE\"=\"red\", \"FALSE\"=\"grey\")) +   stat_outliers(aes(color = after_stat(is_outlier)))   ggplot(df, aes(PC1, PC2, group=Species)) +   geom_hotelling(alpha=0.1, level = .75, aes(fill = Species)) +   stat_outliers(level = .75,                          size=2,                          aes(shape = Species,                          color = after_stat(t2)))   # label the outliers # note that you need to add the label aesthetics for the label geom to # work ggplot(df, aes(PC1, PC2, group=Species, label=rownames(df))) +   geom_hotelling(level = 0.75, alpha=0.1, aes(fill = Species)) +   geom_point(aes(color = Species)) +   stat_outliers(level = .75, geom=\"label\",                          outlier_only = TRUE)"}]
